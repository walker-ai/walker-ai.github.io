---
title: 计算机网络
subtitle:
date: 2025-08-06T01:33:48+08:00
slug: 3dc98a3
draft: false
author:
  name: "yitao"
emoji: true
categories: [找工作]
tags: [八股]
---

计算机网络基础复习

<!--more-->


## TCP 协议与 UDP 协议

### 三次握手

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i43iiass4qj30i80citam.jpg)


#### 为什么三次握手可以建立"可靠"传输？

- 第一次握手：如果成功，Server 则确认 Client的发送信道可靠，Server 也确认 自己的接收信道可靠。
- 第二次握手：如果成功，Client 则确认 Server的发送信道和接收信道都可靠，Client 也确认 自己的发送信道和接收信道都可靠。
- 第三次握手：如果成功，Server 则确认 Client的接收信道可靠，Server 也确认 自己的发送信道可靠。

此时，Server和Client双方都确认 **自己和对方的发送和接收通道已经可以正常运行**。

#### 为什么不进行两次握手？

Server 无法确认 Client 的接收信道和自己的发送信道 是否可靠。即 Server 无法知道客户端是否收到了 SYN-ACK 响应

#### 为什么不需要超过三次握手？

四次或更多次握手将带来不必要的开销，且不会带来额外的可靠性优势，三次足以。

### 四次挥手

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i44gmf7f22j30u00lotef.jpg)

#### 为什么需要四次挥手？

服务器收到客户端的 FIN 报文时，内核会马上回一个 ACK 应答报文，但是服务端应用程序可能还有数据要发送，所以不能马上发送 FIN 报文，而是将发送 FIN 报文的控制权交给服务端应用程序：

- 如果服务端应用程序有数据要发送的话，就发完数据后，才调用关闭连接的函数
- 如果服务端应用程序没有数据要发送的话，可以直接调用关闭连接的函数

#### 什么时候变成三次挥手？

当被动关闭方（上图的服务端）在 TCP 挥手过程中，「没有数据要发送」并且「开启了 TCP 延迟确认机制」，那么第二和第三次挥手就会合并传输，这样就出现了三次挥手。

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i44gr8g6ypj30k8096wf7.jpg)



### 可靠传输

> TCP 是通过序列号、确认应答、校验和、重发控制、连接管理以及窗口控制等机制实现可靠性传输的。

#### 重传机制

常见的重传机制

- 超时重传
- 快速重传
- SACK
- D-SACK

数据包在传输过程中丢失，这时就需要使用重传机制。

#### 流量控制

TCP 利用滑动窗口实现流量控制。流量控制是为了控制发送方发送速率，保证接收方来得及接收

发送窗口图示，可以分为四个部分：

1. 已经发送并且确认的 TCP 段（已经发送并确认）
2. 已经发送但是没有确认的 TCP 段（已经发送未确认）
3. 未发送但是接收方准备接收的 TCP 段（可以发送）
4. 未发送并且接收方也并未准备接受的 TCP 段（不可发送）

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i44hfdrfrtj30rl0gy0vz.jpg)

接收窗口图示，可以分为三个部分：

1. 已经接收并且已经确认的 TCP 段（已经接收并确认）
2. 等待接收且允许发送方发送 TCP 段（可以接收未确认）
3. 不可接收且不允许发送方发送 TCP 段（不可接收）

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i44hg5ul63j30rb0gbacv.jpg)

#### 拥塞控制

拥塞控制就是为了防止过多的数据注入到网络中，

![image](https://cdn.ipfsscan.io/weibo/large/005wRZF3ly1i44hivfj5nj30u00algoq.jpg)

为了进行拥塞控制，TCP 发送方要维持一个 **拥塞窗口(cwnd)** 的状态变量。拥塞控制窗口的大小取决于网络的拥塞程度，并且动态变化。发送方让自己的发送窗口取为拥塞窗口和接收方的接受窗口中较小的一个。

TCP 的拥塞控制采用了四种算法，即 **慢开始**、 **拥塞避免**、**快重传** 和 **快恢复**。在网络层也可以使路由器采用适当的分组丢弃策略（如主动队列管理 AQM），以减少网络拥塞的发生。

- **慢开始**： 慢开始算法的思路是当主机开始发送数据时，如果立即把大量数据字节注入到网络，那么可能会引起网络阻塞，因为现在还不知道网络的符合情况。经验表明，较好的方法是先探测一下，即由小到大逐渐增大发送窗口，也就是由小到大逐渐增大拥塞窗口数值。cwnd 初始值为 1，每经过一个传播轮次，cwnd 加倍。

- **拥塞避免**： 拥塞避免算法的思路是让拥塞窗口 cwnd 缓慢增大，即每经过一个往返时间 RTT 就把发送方的 cwnd 加 1.

- **快重传与快恢复**： 在 TCP/IP 中，快速重传和恢复（fast retransmit and recovery，FRR）是一种拥塞控制算法，它能快速恢复丢失的数据包。没有 FRR，如果数据包丢失了，TCP 将会使用定时器来要求传输暂停。在暂停的这段时间内，没有新的或复制的数据包被发送。有了 FRR，如果接收机接收到一个不按顺序的数据段，它会立即给发送机发送一个重复确认。如果发送机接收到三个重复确认，它会假定确认件指出的数据段丢失了，并立即重传这些丢失的数据段。有了 FRR，就不会因为重传时要求的暂停被耽误。当有单独的数据包丢失时，快速重传和恢复（FRR）能最有效地工作。当有多个数据信息包在某一段很短的时间内丢失时，它则不能很有效地工作。
